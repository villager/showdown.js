{
  "version": 3,
  "sources": ["../../../../src/managers/cache/formats.ts"],
  "sourcesContent": ["\r\nimport { BaseCache } from \"./base\";\r\nimport {AliasesManager} from './aliases';\r\nimport { toId } from \"../../lib\";\r\nexport class FormatsManager extends BaseCache {\r\n\t/**\r\n\t * Manager of formats\r\n\t * @constructor\r\n\t */\r\n    aliases: AliasesManager;\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\t/** @type {Map<string, AnyObject>|null} */\r\n\t\tthis.aliases = new AliasesManager();\r\n\t}\r\n\tloadAliases(aliases: AnyObject) {\r\n\t\treturn this.aliases.load(aliases);\r\n\t}\r\n\tparseAliases(format: string) {\r\n\t\tif (!format) return '';\r\n\t\tlet f = toId(format) as ID;\r\n\t\tif (this.has(f)) return format;\r\n\t\tif (this.aliases.has(f)) format = toId(this.aliases.get(f));\r\n\t\treturn format;\r\n\t}\r\n\tupdate(formats: string) {\r\n\t\tconst formatsArr = formats.split('|');\r\n\t\tlet commaIndex, formatData, code, name;\r\n\t\tfor (let i = 0; i < formatsArr.length; i++) {\r\n\t\t\tcommaIndex = formatsArr[i].indexOf(',');\r\n\t\t\tif (commaIndex === -1) {\r\n\t\t\t\tthis.create(toId(formatsArr[i]) as ID, {\r\n\t\t\t\t\tname: formatsArr[i],\r\n\t\t\t\t\tteam: true,\r\n\t\t\t\t\tladder: true,\r\n\t\t\t\t\tchall: true,\r\n\t\t\t\t});\r\n\t\t\t} else if (commaIndex === 0) {\r\n\t\t\t\ti++;\r\n\t\t\t\tcontinue;\r\n\t\t\t} else {\r\n\t\t\t\tname = formatsArr[i];\r\n\t\t\t\tformatData = {\r\n\t\t\t\t\tname: name,\r\n\t\t\t\t\tteam: true,\r\n\t\t\t\t\tladder: true,\r\n\t\t\t\t\tchall: true,\r\n\t\t\t\t\tdisableTournaments: false,\r\n\t\t\t\t};\r\n\t\t\t\tcode = commaIndex >= 0 ? parseInt(name.substr(commaIndex + 1), 16) : NaN;\r\n\t\t\t\tif (!isNaN(code)) {\r\n\t\t\t\t\tname = name.substr(0, commaIndex);\r\n\t\t\t\t\tif (code & 1) formatData.team = false;\r\n\t\t\t\t\tif (!(code & 2)) formatData.ladder = false;\r\n\t\t\t\t\tif (!(code & 4)) formatData.chall = false;\r\n\t\t\t\t\tif (!(code & 8)) formatData.disableTournaments = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (name.substr(name.length - 2) === ',#') {\r\n\t\t\t\t\t\t// preset teams\r\n\t\t\t\t\t\tformatData.team = false;\r\n\t\t\t\t\t\tname = name.substr(0, name.length - 2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (name.substr(name.length - 2) === ',,') {\r\n\t\t\t\t\t\t// search-only\r\n\t\t\t\t\t\tformatData.chall = false;\r\n\t\t\t\t\t\tname = name.substr(0, name.length - 2);\r\n\t\t\t\t\t} else if (name.substr(name.length - 1) === ',') {\r\n\t\t\t\t\t\t// challenge-only\r\n\t\t\t\t\t\tformatData.ladder = false;\r\n\t\t\t\t\t\tname = name.substr(0, name.length - 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tformatData.name = name;\r\n\t\t\t\tthis.create(toId(name) as ID, formatData);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,kBAA0B;AAC1B,qBAA6B;AAC7B,iBAAqB;AACd,MAAM,uBAAuB,sBAAU;AAAA,EAM7C,cAAc;AACb,UAAM;AAEN,SAAK,UAAU,IAAI,8BAAe;AAAA,EACnC;AAAA,EACA,YAAY,SAAoB;AAC/B,WAAO,KAAK,QAAQ,KAAK,OAAO;AAAA,EACjC;AAAA,EACA,aAAa,QAAgB;AAC5B,QAAI,CAAC;AAAQ,aAAO;AACpB,QAAI,QAAI,iBAAK,MAAM;AACnB,QAAI,KAAK,IAAI,CAAC;AAAG,aAAO;AACxB,QAAI,KAAK,QAAQ,IAAI,CAAC;AAAG,mBAAS,iBAAK,KAAK,QAAQ,IAAI,CAAC,CAAC;AAC1D,WAAO;AAAA,EACR;AAAA,EACA,OAAO,SAAiB;AACvB,UAAM,aAAa,QAAQ,MAAM,GAAG;AACpC,QAAI,YAAY,YAAY,MAAM;AAClC,aAAS,IAAI,GAAG,IAAI,WAAW,QAAQ,KAAK;AAC3C,mBAAa,WAAW,CAAC,EAAE,QAAQ,GAAG;AACtC,UAAI,eAAe,IAAI;AACtB,aAAK,WAAO,iBAAK,WAAW,CAAC,CAAC,GAAS;AAAA,UACtC,MAAM,WAAW,CAAC;AAAA,UAClB,MAAM;AAAA,UACN,QAAQ;AAAA,UACR,OAAO;AAAA,QACR,CAAC;AAAA,MACF,WAAW,eAAe,GAAG;AAC5B;AACA;AAAA,MACD,OAAO;AACN,eAAO,WAAW,CAAC;AACnB,qBAAa;AAAA,UACZ;AAAA,UACA,MAAM;AAAA,UACN,QAAQ;AAAA,UACR,OAAO;AAAA,UACP,oBAAoB;AAAA,QACrB;AACA,eAAO,cAAc,IAAI,SAAS,KAAK,OAAO,aAAa,CAAC,GAAG,EAAE,IAAI;AACrE,YAAI,CAAC,MAAM,IAAI,GAAG;AACjB,iBAAO,KAAK,OAAO,GAAG,UAAU;AAChC,cAAI,OAAO;AAAG,uBAAW,OAAO;AAChC,cAAI,EAAE,OAAO;AAAI,uBAAW,SAAS;AACrC,cAAI,EAAE,OAAO;AAAI,uBAAW,QAAQ;AACpC,cAAI,EAAE,OAAO;AAAI,uBAAW,qBAAqB;AAAA,QAClD,OAAO;AACN,cAAI,KAAK,OAAO,KAAK,SAAS,CAAC,MAAM,MAAM;AAE1C,uBAAW,OAAO;AAClB,mBAAO,KAAK,OAAO,GAAG,KAAK,SAAS,CAAC;AAAA,UACtC;AACA,cAAI,KAAK,OAAO,KAAK,SAAS,CAAC,MAAM,MAAM;AAE1C,uBAAW,QAAQ;AACnB,mBAAO,KAAK,OAAO,GAAG,KAAK,SAAS,CAAC;AAAA,UACtC,WAAW,KAAK,OAAO,KAAK,SAAS,CAAC,MAAM,KAAK;AAEhD,uBAAW,SAAS;AACpB,mBAAO,KAAK,OAAO,GAAG,KAAK,SAAS,CAAC;AAAA,UACtC;AAAA,QACD;AACA,mBAAW,OAAO;AAClB,aAAK,WAAO,iBAAK,IAAI,GAAS,UAAU;AAAA,MACzC;AAAA,IACD;AAAA,EACD;AACD;",
  "names": []
}
