{
  "version": 3,
  "sources": ["../../../src/managers/connection.ts"],
  "sourcesContent": ["'use strict';\r\n\r\nconst DEFAULT_TRY_RECONNECT = 30 * 1000;\r\n\r\nimport { Client } from \"../client\";\r\nimport { ActivityManager } from \"./activity\";\r\ninterface StatusType {\r\n\tconnected: boolean;\r\n\tnamed?: boolean;\r\n}\r\nexport class ConnectionManager {\r\n    client: Client\r\n    connecting: boolean;\r\n    closed: boolean;\r\n    maxAttemps: number;\r\n    attemps: number;\r\n    activity: ActivityManager;\r\n    conntime: number;\r\n    _timer: null| NodeJS.Timer;\r\n    time: number;\r\n\tstatus: StatusType;\r\n\tconstructor(client: Client) {\r\n        this.client = client;\r\n\t\tthis.connecting = false;\r\n\t\tthis.status = {connected: false};\r\n\t\tthis.closed = false;\r\n\t\tthis.maxAttemps = client.reconnect ? client.reconnect.attemps : 3;\r\n\t\tthis.attemps = 0;\r\n\t\tthis.activity = new ActivityManager(this.client);\r\n\t\tthis.conntime = 0;\r\n\t\tthis._timer = null;\r\n\t\tthis.time = client.reconnect ? client.reconnect.time : DEFAULT_TRY_RECONNECT;\r\n\t}\r\n\t_clear() {\r\n\t\tif (!this._timer) return;\r\n\t\tclearTimeout(this._timer);\r\n\t\tthis._timer = null;\r\n\t}\r\n\treconnect() {\r\n\t\tthis._clear();\r\n\t\tthis._timer = setTimeout(() => {\r\n\t\t\tif (this.closed) return;\r\n\t\t\tthis.client.socket.on();\r\n\t\t\tthis.attemps++;\r\n\t\t\tif (this.attemps > this.maxAttemps) {\r\n\t\t\t\tthis.activity._clear();\r\n\t\t\t\tthis.closed = true;\r\n\t\t\t\tconsole.log(`Connection closed to ${this.client.id}`);\r\n\t\t\t}\r\n\t\t}, this.time);\r\n\t}\r\n}"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA,sBAAgC;AAHhC,MAAM,wBAAwB,KAAK;AAQ5B,MAAM,kBAAkB;AAAA,EAW9B,YAAY,QAAgB;AACrB,SAAK,SAAS;AACpB,SAAK,aAAa;AAClB,SAAK,SAAS,EAAC,WAAW,MAAK;AAC/B,SAAK,SAAS;AACd,SAAK,aAAa,OAAO,YAAY,OAAO,UAAU,UAAU;AAChE,SAAK,UAAU;AACf,SAAK,WAAW,IAAI,gCAAgB,KAAK,MAAM;AAC/C,SAAK,WAAW;AAChB,SAAK,SAAS;AACd,SAAK,OAAO,OAAO,YAAY,OAAO,UAAU,OAAO;AAAA,EACxD;AAAA,EACA,SAAS;AACR,QAAI,CAAC,KAAK;AAAQ;AAClB,iBAAa,KAAK,MAAM;AACxB,SAAK,SAAS;AAAA,EACf;AAAA,EACA,YAAY;AACX,SAAK,OAAO;AACZ,SAAK,SAAS,WAAW,MAAM;AAC9B,UAAI,KAAK;AAAQ;AACjB,WAAK,OAAO,OAAO,GAAG;AACtB,WAAK;AACL,UAAI,KAAK,UAAU,KAAK,YAAY;AACnC,aAAK,SAAS,OAAO;AACrB,aAAK,SAAS;AACd,gBAAQ,IAAI,wBAAwB,KAAK,OAAO,IAAI;AAAA,MACrD;AAAA,IACD,GAAG,KAAK,IAAI;AAAA,EACb;AACD;",
  "names": []
}
